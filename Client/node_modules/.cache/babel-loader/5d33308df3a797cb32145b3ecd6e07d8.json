{"ast":null,"code":"var _jsxFileName = \"/Users/rhysconnolly/SKEEEEET/client/src/components/ContractInteraction.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport MusicOwnership from '../artifacts/MusicOwnership.json';\nimport Web3 from 'web3';\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport styles from './CSS Modules/FileInputButtons-style.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ContractInteraction(props) {\n  _s();\n\n  ///////Webpage State components///////\n  const [accounts, setAccounts] = useState([]); //state variable for accounts\n\n  const [web3, setWeb3] = useState(undefined); //web3 state\n\n  const [contract, setContract] = useState(undefined); //contract state\n\n  const [uri, setUri] = useState(undefined); //Uri code State\n\n  const [tokenID, setTokenID] = useState(undefined); //Token ID state\n\n  const [tokenExists, setTokenExists] = useState(false); //Triggers Token UI response on and off\n\n  const [reciever, setReciever] = useState(undefined);\n  const [url, setUrl] = useState(undefined); //Metadata URL state\n\n  const [doesntExist, setDoesntExist] = useState(undefined); //switch for Token ID response\n\n  const [connectionStatus, setConnectionStatus] = useState(false);\n  const [owner, setOwner] = useState(undefined);\n  const [transactionStatus, setTransactionStatus] = useState(false);\n  const [mintSuccess, setMintsuccess] = useState(false); //Initialise state variables and connect to Smart Contract//\n\n  async function init() {\n    try {\n      const uri = await props.CIDkey;\n      const tokenID = await props.tokenIDs;\n      const web3 = await new Web3(window.ethereum);\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = MusicOwnership.networks[networkId];\n      const contract = await new web3.eth.Contract(MusicOwnership.abi, deployedNetwork && deployedNetwork.address);\n      await setUri(uri);\n      await setWeb3(web3);\n      await setAccounts(accounts);\n      await setContract(contract);\n    } catch (error) {\n      alert(`Failed to load web3, accounts or contract from the abi. Check console For details.`);\n      console.error(error);\n    }\n  } ///////Configure wallet and connect to Metamask///////\n\n\n  async function configureAndConnectMetamask() {\n    const provider = await detectEthereumProvider({\n      mustBeMetaMask: true\n    });\n\n    if (provider) {\n      try {\n        await provider.request({\n          method: 'eth_requestAccounts'\n        });\n        await provider.request({\n          method: 'wallet_addEthereumChain',\n          params: [{\n            chainId: '0x3',\n            chainName: 'Ropsten',\n            nativeCurrency: {\n              name: 'ETH',\n              symbol: 'ETH',\n              decimals: 18\n            },\n            rpcUrls: ['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],\n            blockExplorerUrls: ['https://ropsten.etherscan.io']\n          }]\n        });\n      } catch (e) {\n        console.error(e);\n        setConnectionStatus(true);\n      }\n    } else {\n      console.error('Please install MetaMask');\n      alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');\n    }\n\n    await init();\n  } ///////Function for submitting a token Id////////\n\n\n  const handleSubmit = evt => {\n    evt.preventDefault();\n    console.log(props.showCIDs);\n    console.log(tokenID);\n    RetrieveTokenURL(tokenID);\n  };\n\n  const handleChange = e => {\n    setTokenID(e.target.value);\n  }; ////////////Mint a new Token////////////\n\n\n  async function Mint() {\n    if (uri === undefined || tokenID === undefined) {\n      alert('please ensure a file first and that you have entered a numerical Identification number');\n      throw 'please ensure a file is submitted first and that you have entered a numerical Identification number';\n    }\n\n    let checkID = await contract.methods.tokenURI(tokenID).call();\n\n    if (checkID = !null) {\n      alert('This ID number has been taken, please try a different number');\n      throw 'This ID number has been taken, please try a different number';\n    }\n\n    try {\n      await contract.methods.mint(accounts[0], uri, tokenID).send({\n        from: accounts[0],\n        gas: 1000000\n      });\n    } catch (error) {\n      alert('Transaction Failed');\n      throw 'Transaction Failed';\n    }\n\n    setMintsuccess(true);\n  } ///User input for TokenID request///\n\n\n  const handleRecieverSubmit = evt => {\n    evt.preventDefault();\n    alert(`Submitting ID: ${reciever}`);\n    setReciever(reciever);\n  };\n\n  const handleRecieverChange = e => {\n    setReciever(e.target.value);\n  }; /////////Retrieve a Token's Metadata and source File/////////\n\n\n  async function RetrieveTokenURL() {\n    if (tokenID === undefined) {\n      alert('please enter a numerical Identification number');\n      throw 'please enter a numerical Identification number';\n    }\n\n    try {\n      const url = await contract.methods.tokenURI(tokenID).call();\n      setUrl(url);\n      console.log(JSON.stringify(url));\n      const owner = await contract.methods.ownerOf(tokenID).call();\n      setOwner(owner);\n      setTokenExists(true);\n    } catch (error) {\n      setDoesntExist('This Token ID does not exist and is available to be used');\n      setTokenExists(false);\n    }\n  }\n\n  async function TransferToken() {\n    console.log(reciever);\n    console.log(tokenID);\n    console.log(accounts[0]);\n\n    if ({\n      reciever\n    } == null || {\n      tokenID\n    } == null || accounts[0] == null) {\n      alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted');\n      throw 'Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted';\n    }\n\n    try {\n      await contract.methods.transferFrom(accounts[0], reciever, tokenID).send({\n        from: accounts[0],\n        gas: 1000000\n      });\n      console.log(reciever);\n      setTransactionStatus(true);\n    } catch (error) {\n      alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"3. Connect To Your Wallet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => configureAndConnectMetamask(),\n          children: \"Connect to Ropsten \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this), connectionStatus ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Account:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: [\" \", accounts[0]]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"NotConnected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"4. Enter a TokenID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            value: tokenID,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.column,\n          children: tokenExists ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: [\"Track \", tokenID, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 15\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: [url, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              children: [\"Owner of Track \", tokenID, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: owner\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 50\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this) : /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: doesntExist\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \" 5. Mint Your Token\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => Mint(),\n          children: \" Mint Token \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), mintSuccess ? /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Minting was succesfull\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 14\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Transfer Ownership\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleRecieverSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: reciever,\n            onChange: handleRecieverChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 11\n        }, this), transactionStatus ? /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Transaction Was Succesfull\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 10\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: TransferToken,\n          children: \"Transfer Token\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ContractInteraction, \"V3mAW5X66x6YZ86hDWjfA6F4WD0=\");\n\n_c = ContractInteraction;\nexport default ContractInteraction;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContractInteraction\");","map":{"version":3,"sources":["/Users/rhysconnolly/SKEEEEET/client/src/components/ContractInteraction.js"],"names":["React","useState","MusicOwnership","Web3","detectEthereumProvider","styles","ContractInteraction","props","accounts","setAccounts","web3","setWeb3","undefined","contract","setContract","uri","setUri","tokenID","setTokenID","tokenExists","setTokenExists","reciever","setReciever","url","setUrl","doesntExist","setDoesntExist","connectionStatus","setConnectionStatus","owner","setOwner","transactionStatus","setTransactionStatus","mintSuccess","setMintsuccess","init","CIDkey","tokenIDs","window","ethereum","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","Contract","abi","address","error","alert","console","configureAndConnectMetamask","provider","mustBeMetaMask","request","method","params","chainId","chainName","nativeCurrency","name","symbol","decimals","rpcUrls","blockExplorerUrls","e","handleSubmit","evt","preventDefault","log","showCIDs","RetrieveTokenURL","handleChange","target","value","Mint","checkID","methods","tokenURI","call","mint","send","from","gas","handleRecieverSubmit","handleRecieverChange","JSON","stringify","ownerOf","TransferToken","transferFrom","componentheaders","componentspacing","column"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport MusicOwnership from '../artifacts/MusicOwnership.json';\nimport Web3 from 'web3';\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport styles from './CSS Modules/FileInputButtons-style.module.css';\n\nfunction ContractInteraction (props) {\n\n  ///////Webpage State components///////\n  const [accounts, setAccounts] = useState([]); //state variable for accounts\n  const [web3, setWeb3] = useState (undefined); //web3 state\n  const [contract, setContract] = useState (undefined); //contract state\n  const [uri, setUri] = useState (undefined); //Uri code State\n  const [tokenID, setTokenID] = useState (undefined); //Token ID state\n  const [tokenExists, setTokenExists] = useState (false); //Triggers Token UI response on and off\n  const [reciever,setReciever ] = useState (undefined);\n  const [url, setUrl] = useState (undefined); //Metadata URL state\n  const [doesntExist, setDoesntExist] = useState(undefined); //switch for Token ID response\n  const [connectionStatus, setConnectionStatus] = useState(false);\n  const [owner, setOwner] = useState(undefined);\n  const [transactionStatus,setTransactionStatus] = useState(false);\n  const [mintSuccess, setMintsuccess] = useState(false);\n  \n    \n  //Initialise state variables and connect to Smart Contract//\n  async function init() {\n             \n    try {\n      const uri = await (props.CIDkey); \n      const tokenID = await (props.tokenIDs);   \n      const  web3 = await new Web3(window.ethereum);\n      const accounts = await  web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = MusicOwnership.networks[networkId];\n      const contract = await new web3.eth.Contract(\n      MusicOwnership.abi,\n      deployedNetwork && deployedNetwork.address\n      );\n      await setUri(uri);\n      await setWeb3(web3);\n      await setAccounts(accounts);\n      await setContract(contract);\n      }\n\n    catch (error) {\n      alert(`Failed to load web3, accounts or contract from the abi. Check console For details.`);\n      console.error(error);\n    }\n  }\n    \n  ///////Configure wallet and connect to Metamask///////\n\n  async function configureAndConnectMetamask() {\n    const provider = await detectEthereumProvider({\n      mustBeMetaMask: true\n      })\n    if (provider) {\n      try {\n        await provider.request({ method: 'eth_requestAccounts'})\n        await provider.request({\n          method: 'wallet_addEthereumChain',\n          params: [{\n            chainId: '0x3', \n            chainName: 'Ropsten',\n            nativeCurrency: {\n              name: 'ETH',\n              symbol: 'ETH',\n              decimals: 18\n              },\n            rpcUrls: ['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],\n            blockExplorerUrls: ['https://ropsten.etherscan.io']\n            }]\n          })\n        } \n      catch(e) {\n        console.error(e);\n        setConnectionStatus(true);\n        }  \n      } \n    else {\n      console.error('Please install MetaMask');\n      alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');\n    }\n    await init();\n  }\n\n  ///////Function for submitting a token Id////////\n  const handleSubmit = (evt) => {\n    evt.preventDefault();\n    console.log(props.showCIDs);\n    console.log(tokenID);\n    RetrieveTokenURL(tokenID);\n    }\n      \n  const handleChange = (e) => {\n  setTokenID(e.target.value)\n  }\n\n\n  ////////////Mint a new Token////////////\n  async function Mint() {\n    if (uri === undefined || tokenID === undefined) {\n      alert('please ensure a file first and that you have entered a numerical Identification number');\n      throw('please ensure a file is submitted first and that you have entered a numerical Identification number');\n    }\n             \n    let checkID = await contract.methods.tokenURI(tokenID).call();\n\n    if (checkID =! null)\n      {\n        alert('This ID number has been taken, please try a different number');\n        throw('This ID number has been taken, please try a different number');\n      }\n    try {\n        await contract.methods.mint(accounts[0],uri,tokenID).send({from:accounts[0], gas: 1000000});\n      }\n    catch(error) {\n      alert('Transaction Failed');\n      throw('Transaction Failed');\n    }\n    setMintsuccess(true);\n  }\n\n  ///User input for TokenID request///\n  const handleRecieverSubmit = (evt) => {\n    evt.preventDefault();\n    alert(`Submitting ID: ${reciever}`)\n    setReciever(reciever);\n    }\n  const handleRecieverChange = (e) => {\n  setReciever(e.target.value)\n  }\n\n  /////////Retrieve a Token's Metadata and source File/////////\n  async function RetrieveTokenURL() {\n    if (tokenID === undefined)\n      {\n        alert('please enter a numerical Identification number');\n        throw('please enter a numerical Identification number');\n      }\n            \n    try {\n      const url = await contract.methods.tokenURI(tokenID).call();\n      setUrl(url);\n      console.log(JSON.stringify(url));\n      const owner = await contract.methods.ownerOf(tokenID).call();\n      setOwner(owner);\n      setTokenExists(true);\n    }\n    catch(error){\n    setDoesntExist('This Token ID does not exist and is available to be used');\n    setTokenExists(false);\n    }\n  }\n\n              \n  async function TransferToken()  {\n    console.log(reciever);\n    console.log(tokenID);\n    console.log(accounts[0]);\n    if ({reciever} == null || {tokenID} == null || accounts[0] == null){\n      alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n      throw('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n    }\n\n    try {\n      await contract.methods.transferFrom(accounts[0],reciever,tokenID).send({from:accounts[0], gas: 1000000});\n      console.log(reciever)\n      setTransactionStatus(true);\n      }\n    catch(error)  {\n      alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');\n    }\n  }\n\n  return (\n    <div>\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n        <h2>3. Connect To Your Wallet</h2>\n          <button onClick={() => configureAndConnectMetamask() }>Connect to Ropsten </button>\n        {connectionStatus ? (\n        <div> \n          <h3>Account:</h3>\n          <h5> {accounts[0]}</h5>\n        </div>) : (<h4>NotConnected</h4>)}\n        </div>\n      </div>\n     \n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2>4. Enter a TokenID</h2>\n          <form onSubmit= {handleSubmit}>\n          <input type=\"number\" value={tokenID} onChange= {handleChange}/>\n          <input type=\"submit\" value=\"Submit\" />\n          </form>\n\n          <div className={styles.column}>\n       \n          {tokenExists ? (\n            <div>\n              <h3>Track {tokenID}:</h3> <h5>{url} </h5>\n              <h4>Owner of Track {tokenID}:</h4> <h5>{owner}</h5>\n            </div>\n            ) : (\n            <h4>{doesntExist}</h4>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2> 5. Mint Your Token</h2>\n          <button onClick = {() => Mint()}> Mint Token </button>\n        </div>\n        {mintSuccess ? (\n          <h4>Minting was succesfull</h4>\n        ) : (<p></p>)}\n      </div>\n\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2>Transfer Ownership</h2>\n          <form onSubmit= {handleRecieverSubmit}> \n            <input type=\"text\" value={reciever} onChange= {handleRecieverChange}/>\n            <input type=\"submit\" value=\"Submit\" />\n          </form>\n          {transactionStatus ? (\n         <h4>Transaction Was Succesfull</h4>\n          ) : (<p></p>)}\n          <button onClick={TransferToken}>Transfer Token</button>\n        </div>\n      </div>\n    </div>\n     \n  );\n}\nexport default ContractInteraction"]},"metadata":{},"sourceType":"module"}