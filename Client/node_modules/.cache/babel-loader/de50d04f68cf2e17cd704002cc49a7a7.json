{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rhysconnolly/Desktop/mymusicapp/Client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rhysconnolly/Desktop/mymusicapp/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rhysconnolly/Desktop/mymusicapp/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import MusicOwnership from'../artifacts/MusicOwnership.json';import Web3 from'web3';import detectEthereumProvider from'@metamask/detect-provider';import styles from'./CSS Modules/FileInputButtons-style.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ContractInteraction(props){///////Webpage State components///////\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),accounts=_useState2[0],setAccounts=_useState2[1];//state variable for accounts\nvar _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),web3=_useState4[0],setWeb3=_useState4[1];//web3 state\nvar _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),contract=_useState6[0],setContract=_useState6[1];//contract state\nvar _useState7=useState(undefined),_useState8=_slicedToArray(_useState7,2),uri=_useState8[0],setUri=_useState8[1];//Uri code State\nvar _useState9=useState(undefined),_useState10=_slicedToArray(_useState9,2),tokenID=_useState10[0],setTokenID=_useState10[1];//Token ID state\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),tokenExists=_useState12[0],setTokenExists=_useState12[1];//Triggers Token UI response on and off\nvar _useState13=useState(undefined),_useState14=_slicedToArray(_useState13,2),reciever=_useState14[0],setReciever=_useState14[1];var _useState15=useState(undefined),_useState16=_slicedToArray(_useState15,2),url=_useState16[0],setUrl=_useState16[1];//Metadata URL state\nvar _useState17=useState(undefined),_useState18=_slicedToArray(_useState17,2),doesntExist=_useState18[0],setDoesntExist=_useState18[1];//switch for Token ID response\nvar _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),connectionStatus=_useState20[0],setConnectionStatus=_useState20[1];var _useState21=useState(undefined),_useState22=_slicedToArray(_useState21,2),owner=_useState22[0],setOwner=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),transactionStatus=_useState24[0],setTransactionStatus=_useState24[1];//Initialise state variables and connect to Smart Contract//\nfunction init(){return _init.apply(this,arguments);}///////Configure wallet and connect to Metamask///////\nfunction _init(){_init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _uri,_tokenID,_web,_accounts,networkId,deployedNetwork,_contract;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return props.CIDkey;case 3:_uri=_context.sent;_context.next=6;return props.tokenIDs;case 6:_tokenID=_context.sent;_context.next=9;return new Web3(window.ethereum);case 9:_web=_context.sent;_context.next=12;return _web.eth.getAccounts();case 12:_accounts=_context.sent;_context.next=15;return _web.eth.net.getId();case 15:networkId=_context.sent;deployedNetwork=MusicOwnership.networks[networkId];_context.next=19;return new _web.eth.Contract(MusicOwnership.abi,deployedNetwork&&deployedNetwork.address);case 19:_contract=_context.sent;_context.next=22;return setUri(_uri);case 22:_context.next=24;return setWeb3(_web);case 24:_context.next=26;return setAccounts(_accounts);case 26:_context.next=28;return setContract(_contract);case 28:_context.next=34;break;case 30:_context.prev=30;_context.t0=_context[\"catch\"](0);alert(\"Failed to load web3, accounts or contract from the abi. Check console For details.\");console.error(_context.t0);case 34:case\"end\":return _context.stop();}}},_callee,null,[[0,30]]);}));return _init.apply(this,arguments);}function configureAndConnectMetamask(){return _configureAndConnectMetamask.apply(this,arguments);}///////Function for submitting a token Id////////\nfunction _configureAndConnectMetamask(){_configureAndConnectMetamask=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var provider;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return detectEthereumProvider({mustBeMetaMask:true});case 2:provider=_context2.sent;if(!provider){_context2.next=17;break;}_context2.prev=4;_context2.next=7;return provider.request({method:'eth_requestAccounts'});case 7:_context2.next=9;return provider.request({method:'wallet_addEthereumChain',params:[{chainId:'0x3',chainName:'Ropsten',nativeCurrency:{name:'ETH',symbol:'ETH',decimals:18},rpcUrls:['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],blockExplorerUrls:['https://ropsten.etherscan.io']}]});case 9:_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](4);console.error(_context2.t0);setConnectionStatus(true);case 15:_context2.next=19;break;case 17:console.error('Please install MetaMask');alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');case 19:_context2.next=21;return init();case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[4,11]]);}));return _configureAndConnectMetamask.apply(this,arguments);}var handleSubmit=function handleSubmit(evt){evt.preventDefault();console.log(props.showCIDs);console.log(tokenID);RetrieveTokenURL(tokenID);};var handleChange=function handleChange(e){setTokenID(e.target.value);};////////////Mint a new Token////////////\nfunction Mint(){return _Mint.apply(this,arguments);}///User input for TokenID request///\nfunction _Mint(){_Mint=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var checkID;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(uri===undefined||tokenID===undefined)){_context3.next=3;break;}alert('please ensure a file first and that you have entered a numerical Identification number');throw'please ensure a file is submitted first and that you have entered a numerical Identification number';case 3:_context3.next=5;return contract.methods.tokenURI(tokenID).call();case 5:checkID=_context3.sent;if(!(checkID=!null)){_context3.next=9;break;}alert('This ID number has been taken, please try a different number');throw'This ID number has been taken, please try a different number';case 9:_context3.prev=9;_context3.next=12;return contract.methods.mint(accounts[0],uri,tokenID).send({from:accounts[0],gas:1000000});case 12:_context3.next=18;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](9);alert('Transaction Failed');throw'Transaction Failed';case 18:alert('You succesfully minted your token.');case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[9,14]]);}));return _Mint.apply(this,arguments);}var handleRecieverSubmit=function handleRecieverSubmit(evt){evt.preventDefault();alert(\"Submitting ID: \".concat(reciever));setReciever(reciever);};var handleRecieverChange=function handleRecieverChange(e){setReciever(e.target.value);};/////////Retrieve a Token's Metadata and source File/////////\nfunction RetrieveTokenURL(){return _RetrieveTokenURL.apply(this,arguments);}function _RetrieveTokenURL(){_RetrieveTokenURL=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _url,_owner;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(tokenID===undefined)){_context4.next=3;break;}alert('please enter a numerical Identification number');throw'please enter a numerical Identification number';case 3:_context4.prev=3;_context4.next=6;return contract.methods.tokenURI(tokenID).call();case 6:_url=_context4.sent;setUrl(_url);console.log(JSON.stringify(_url));_context4.next=11;return contract.methods.ownerOf(tokenID).call();case 11:_owner=_context4.sent;setOwner(_owner);setTokenExists(true);_context4.next=20;break;case 16:_context4.prev=16;_context4.t0=_context4[\"catch\"](3);setDoesntExist('This Token ID does not exist and is available to be used');setTokenExists(false);case 20:case\"end\":return _context4.stop();}}},_callee4,null,[[3,16]]);}));return _RetrieveTokenURL.apply(this,arguments);}function TransferToken(){return _TransferToken.apply(this,arguments);}function _TransferToken(){_TransferToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(reciever);console.log(tokenID);console.log(accounts[0]);if(!({reciever:reciever}==null||{tokenID:tokenID}==null||accounts[0]==null)){_context5.next=6;break;}alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted');throw'Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted';case 6:_context5.prev=6;_context5.next=9;return contract.methods.transferFrom(accounts[0],reciever,tokenID).send({from:accounts[0],gas:1000000});case 9:console.log(reciever);setTransactionStatus(true);_context5.next=16;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](6);alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');case 16:case\"end\":return _context5.stop();}}},_callee5,null,[[6,13]]);}));return _TransferToken.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:styles.componentheaders,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.componentspacing,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"3. Connect To Your Wallet\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return configureAndConnectMetamask();},children:\"Connect to Ropsten \"}),connectionStatus?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Account:\"}),/*#__PURE__*/_jsxs(\"h5\",{children:[\" \",accounts[0]]})]}):/*#__PURE__*/_jsx(\"h4\",{children:\"NotConnected\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.componentheaders,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.componentspacing,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"4. Enter a TokenID\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:tokenID,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Submit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.column,children:tokenExists?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Track \",tokenID,\":\"]}),\" \",/*#__PURE__*/_jsxs(\"h5\",{children:[url,\" \"]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Owner of Track \",tokenID,\":\"]}),\" \",/*#__PURE__*/_jsx(\"h5\",{children:owner})]}):/*#__PURE__*/_jsx(\"h4\",{children:doesntExist})})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.componentheaders,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.componentspacing,children:[/*#__PURE__*/_jsx(\"h2\",{children:\" 5. Mint Your Token\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return Mint();},children:\" Mint Token \"})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.componentheaders,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.componentspacing,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Transfer Ownership\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRecieverSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:reciever,onChange:handleRecieverChange}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Submit\"})]}),transactionStatus?/*#__PURE__*/_jsx(\"h4\",{children:\"Transaction Was Succesfull\"}):/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:TransferToken,children:\"Transfer Token\"})]})})]});}export default ContractInteraction;","map":{"version":3,"sources":["/Users/rhysconnolly/Desktop/mymusicapp/Client/src/components/ContractInteraction.js"],"names":["React","useState","MusicOwnership","Web3","detectEthereumProvider","styles","ContractInteraction","props","accounts","setAccounts","undefined","web3","setWeb3","contract","setContract","uri","setUri","tokenID","setTokenID","tokenExists","setTokenExists","reciever","setReciever","url","setUrl","doesntExist","setDoesntExist","connectionStatus","setConnectionStatus","owner","setOwner","transactionStatus","setTransactionStatus","init","CIDkey","tokenIDs","window","ethereum","eth","getAccounts","net","getId","networkId","deployedNetwork","networks","Contract","abi","address","alert","console","error","configureAndConnectMetamask","mustBeMetaMask","provider","request","method","params","chainId","chainName","nativeCurrency","name","symbol","decimals","rpcUrls","blockExplorerUrls","handleSubmit","evt","preventDefault","log","showCIDs","RetrieveTokenURL","handleChange","e","target","value","Mint","methods","tokenURI","call","checkID","mint","send","from","gas","handleRecieverSubmit","handleRecieverChange","JSON","stringify","ownerOf","TransferToken","transferFrom","componentheaders","componentspacing","column"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport MusicOwnership from '../artifacts/MusicOwnership.json';\nimport Web3 from 'web3';\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport styles from './CSS Modules/FileInputButtons-style.module.css';\n\nfunction ContractInteraction (props) {\n\n  ///////Webpage State components///////\n  const [accounts, setAccounts] = useState([]); //state variable for accounts\n  const [web3, setWeb3] = useState (undefined); //web3 state\n  const [contract, setContract] = useState (undefined); //contract state\n  const [uri, setUri] = useState (undefined); //Uri code State\n  const [tokenID, setTokenID] = useState (undefined); //Token ID state\n  const [tokenExists, setTokenExists] = useState (false); //Triggers Token UI response on and off\n  const [reciever,setReciever ] = useState (undefined);\n  const [url, setUrl] = useState (undefined); //Metadata URL state\n  const [doesntExist, setDoesntExist] = useState(undefined); //switch for Token ID response\n  const [connectionStatus, setConnectionStatus] = useState(false);\n  const [owner, setOwner] = useState(undefined);\n  const [transactionStatus,setTransactionStatus] = useState(false);\n  \n    \n  //Initialise state variables and connect to Smart Contract//\n  async function init() {\n             \n    try {\n      const uri = await (props.CIDkey); \n      const tokenID = await (props.tokenIDs);   \n      const  web3 = await new Web3(window.ethereum);\n      const accounts = await  web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = MusicOwnership.networks[networkId];\n      const contract = await new web3.eth.Contract(\n      MusicOwnership.abi,\n      deployedNetwork && deployedNetwork.address\n      );\n      await setUri(uri);\n      await setWeb3(web3);\n      await setAccounts(accounts);\n      await setContract(contract);\n      }\n\n    catch (error) {\n      alert(`Failed to load web3, accounts or contract from the abi. Check console For details.`);\n      console.error(error);\n    }\n  }\n    \n  ///////Configure wallet and connect to Metamask///////\n\n  async function configureAndConnectMetamask() {\n    const provider = await detectEthereumProvider({\n      mustBeMetaMask: true\n      })\n    if (provider) {\n      try {\n        await provider.request({ method: 'eth_requestAccounts'})\n        await provider.request({\n          method: 'wallet_addEthereumChain',\n          params: [{\n            chainId: '0x3', \n            chainName: 'Ropsten',\n            nativeCurrency: {\n              name: 'ETH',\n              symbol: 'ETH',\n              decimals: 18\n              },\n            rpcUrls: ['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],\n            blockExplorerUrls: ['https://ropsten.etherscan.io']\n            }]\n          })\n        } \n      catch(e) {\n        console.error(e);\n        setConnectionStatus(true);\n        }  \n      } \n    else {\n      console.error('Please install MetaMask');\n      alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');\n    }\n    await init();\n  }\n\n  ///////Function for submitting a token Id////////\n  const handleSubmit = (evt) => {\n    evt.preventDefault();\n    console.log(props.showCIDs);\n    console.log(tokenID);\n    RetrieveTokenURL(tokenID);\n    }\n      \n  const handleChange = (e) => {\n  setTokenID(e.target.value)\n  }\n\n\n  ////////////Mint a new Token////////////\n  async function Mint() {\n    if (uri === undefined || tokenID === undefined) {\n      alert('please ensure a file first and that you have entered a numerical Identification number');\n      throw('please ensure a file is submitted first and that you have entered a numerical Identification number');\n    }\n             \n    let checkID = await contract.methods.tokenURI(tokenID).call();\n\n    if (checkID =! null)\n      {\n        alert('This ID number has been taken, please try a different number');\n        throw('This ID number has been taken, please try a different number');\n      }\n    try {\n        await contract.methods.mint(accounts[0],uri,tokenID).send({from:accounts[0], gas: 1000000});\n      }\n    catch(error) {\n      alert('Transaction Failed');\n      throw('Transaction Failed');\n    }\n    alert('You succesfully minted your token.');\n  }\n\n  ///User input for TokenID request///\n  const handleRecieverSubmit = (evt) => {\n    evt.preventDefault();\n    alert(`Submitting ID: ${reciever}`)\n    setReciever(reciever);\n    }\n  const handleRecieverChange = (e) => {\n  setReciever(e.target.value)\n  }\n\n  /////////Retrieve a Token's Metadata and source File/////////\n  async function RetrieveTokenURL() {\n    if (tokenID === undefined)\n      {\n        alert('please enter a numerical Identification number');\n        throw('please enter a numerical Identification number');\n      }\n            \n    try {\n      const url = await contract.methods.tokenURI(tokenID).call();\n      setUrl(url);\n      console.log(JSON.stringify(url));\n      const owner = await contract.methods.ownerOf(tokenID).call();\n      setOwner(owner);\n      setTokenExists(true);\n    }\n    catch(error){\n    setDoesntExist('This Token ID does not exist and is available to be used');\n    setTokenExists(false);\n    }\n  }\n\n              \n  async function TransferToken()  {\n    console.log(reciever);\n    console.log(tokenID);\n    console.log(accounts[0]);\n    if ({reciever} == null || {tokenID} == null || accounts[0] == null){\n      alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n      throw('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n    }\n\n    try {\n      await contract.methods.transferFrom(accounts[0],reciever,tokenID).send({from:accounts[0], gas: 1000000});\n      console.log(reciever)\n      setTransactionStatus(true);\n      }\n    catch(error)  {\n      alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');\n    }\n  }\n\n  return (\n    <div>\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n        <h2>3. Connect To Your Wallet</h2>\n          <button onClick={() => configureAndConnectMetamask() }>Connect to Ropsten </button>\n        {connectionStatus ? (\n        <div> \n          <h3>Account:</h3>\n          <h5> {accounts[0]}</h5>\n        </div>) : (<h4>NotConnected</h4>)}\n        </div>\n      </div>\n     \n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2>4. Enter a TokenID</h2>\n          <form onSubmit= {handleSubmit}>\n          <input type=\"number\" value={tokenID} onChange= {handleChange}/>\n          <input type=\"submit\" value=\"Submit\" />\n          </form>\n\n          <div className={styles.column}>\n          {tokenExists ? (\n            <div>\n              <h3>Track {tokenID}:</h3> <h5>{url} </h5>\n              <h4>Owner of Track {tokenID}:</h4> <h5>{owner}</h5>\n            </div>\n            ) : (\n            <h4>{doesntExist}</h4>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2> 5. Mint Your Token</h2>\n          <button onClick = {() => Mint()}> Mint Token </button>\n        </div>\n      </div>\n\n      <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n          <h2>Transfer Ownership</h2>\n          <form onSubmit= {handleRecieverSubmit}> \n            <input type=\"text\" value={reciever} onChange= {handleRecieverChange}/>\n            <input type=\"submit\" value=\"Submit\" />\n          </form>\n          {transactionStatus ? (\n         <h4>Transaction Was Succesfull</h4>\n          ) : (<p></p>)}\n          <button onClick={TransferToken}>Transfer Token</button>\n        </div>\n      </div>\n    </div>\n     \n  );\n}\nexport default ContractInteraction"]},"metadata":{},"sourceType":"module"}