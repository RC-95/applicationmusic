{"ast":null,"code":"var _jsxFileName = \"/Users/rhysconnolly/SKEEEEET/client/src/components/ContractInteraction.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, Component } from 'react';\nimport MusicOwnership from '../artifacts/MusicOwnership.json';\nimport Web3 from 'web3';\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport styles from './CSS Modules/FileInputButtons-style.module.css';\nimport UploadMetadata from \"./UploadMetadata\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ContractInteraction(props) {\n  _s();\n\n  ///////Webpage State components///////\n  const [accounts, setAccounts] = useState([]); //state variable for accounts\n\n  const [web3, setWeb3] = useState(undefined); //web3 state\n\n  const [contract, setContract] = useState(undefined); //contract state\n\n  const [uri, setUri] = useState(undefined); //Uri code State\n\n  const [tokenID, setTokenID] = useState(undefined); //Token ID state\n\n  const [tokenExists, setTokenExists] = useState(false); //Triggers Token UI response on and off\n\n  const [reciever, setReciever] = useState(undefined);\n  const [url, setUrl] = useState(undefined); //Metadata URL state\n\n  const [doesntExist, setDoesntExist] = useState(undefined); //switch for Token ID response\n\n  const [account, setAccount] = useState(false); //Switch for accounts connection status\n\n  const [connectionStatus, setConnectionStatus] = useState(false);\n  const [id, setID] = useState(undefined);\n  const [cid, setCid] = useState(props.showCIDs);\n  const [owner, setOwner] = useState(undefined);\n  const [transactionStatus, setTransactionStatus] = useState(false); ///////Function for submitting a token Id////////\n\n  const handleSubmit = evt => {\n    evt.preventDefault();\n    setCid(props.showCIDs);\n    console.log(props.showCIDs);\n    console.log(tokenID);\n    RetrieveTokenURL(tokenID);\n  };\n\n  const handleChange = e => {\n    setTokenID(e.target.value);\n  }; //Initialise state variables and connect to Smart Contract//\n\n\n  async function init() {\n    try {\n      const uri = await props.CIDkey;\n      const tokenID = await props.tokenIDs;\n      const web3 = await new Web3(window.ethereum);\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = MusicOwnership.networks[networkId];\n      const contract = await new web3.eth.Contract(MusicOwnership.abi, deployedNetwork && deployedNetwork.address);\n      console.log(contract);\n      await setUri(uri);\n      await setWeb3(web3);\n      await setAccounts(accounts);\n      await setContract(contract);\n      console.log(tokenID);\n      console.log(uri);\n      setAccount(true);\n    } catch (error) {\n      alert(`Failed to load web3, accounts or contract from the abi. Check console For details.`);\n      console.error(error);\n    }\n  } ///////Configure wallet and connect to Metamask///////\n\n\n  async function configureAndConnectMetamask() {\n    const provider = await detectEthereumProvider({\n      mustBeMetaMask: true\n    });\n\n    if (provider) {\n      try {\n        await provider.request({\n          method: 'eth_requestAccounts'\n        });\n        await provider.request({\n          method: 'wallet_addEthereumChain',\n          params: [{\n            chainId: '0x3',\n            chainName: 'Ropsten',\n            nativeCurrency: {\n              name: 'ETH',\n              symbol: 'ETH',\n              decimals: 18\n            },\n            rpcUrls: ['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],\n            blockExplorerUrls: ['https://ropsten.etherscan.io']\n          }]\n        });\n      } catch (e) {\n        console.error(e);\n        setConnectionStatus(true);\n      }\n    } else {\n      console.error('Please install MetaMask');\n      alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');\n    }\n\n    await init();\n  } ////////////Mint a new Token////////////\n\n\n  async function Mint() {\n    if (uri === undefined || tokenID === undefined) {\n      alert('please ensure a file first and that you have entered a numerical Identification number');\n      throw 'please ensure a file is submitted first and that you have entered a numerical Identification number';\n    }\n\n    let checkID = await contract.methods.tokenURI(tokenID).call();\n\n    if (checkID = !null) {\n      alert('This ID number has been taken, please try a different number');\n      throw 'This ID number has been taken, please try a different number';\n    }\n\n    await contract.methods.mint(accounts[0], uri, tokenID).send({\n      from: accounts[0],\n      gas: 1000000\n    });\n  }\n\n  if (typeof web3 !== 'undefined' && typeof accounts !== 'undefined' && typeof contract !== 'undefined') {} /////////Retrieve a Token's Metadata and source File/////////\n\n\n  async function RetrieveTokenURL() {\n    if (tokenID === undefined) {\n      alert('please enter a numerical Identification number');\n      throw 'please enter a numerical Identification number';\n    }\n\n    try {\n      const url = await contract.methods.tokenURI(tokenID).call();\n      setUrl(url);\n      console.log(JSON.stringify(url));\n      const owner = await contract.methods.ownerOf(tokenID).call();\n      setOwner(owner);\n      setTokenExists(true);\n    } catch (error) {\n      setDoesntExist('This Token ID does not exit');\n      setTokenExists(false);\n    }\n  }\n\n  const handleRecieverSubmit = evt => {\n    evt.preventDefault();\n    alert(`Submitting ID: ${reciever}`);\n    setReciever(reciever);\n  };\n\n  const handleRecieverChange = e => {\n    setReciever(e.target.value);\n  };\n\n  async function TransferToken() {\n    console.log(reciever);\n    console.log(tokenID);\n    console.log(accounts[0]);\n\n    if ({\n      reciever\n    } == null || {\n      tokenID\n    } == null || accounts[0] == null) {\n      alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted');\n      throw 'Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted';\n    }\n\n    try {\n      await contract.methods.transfer({\n        reciever\n      }, accounts[0], {\n        tokenID\n      }).send({\n        from: accounts[0],\n        gas: 1000000\n      });\n      console.log(reciever);\n      setTransactionStatus(true);\n    } catch (error) {\n      alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"3. Connect To Your Wallet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => configureAndConnectMetamask(),\n            children: \"Connect to Ropsten \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 8\n        }, this), connectionStatus ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Account:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: [\" \", accounts[0]]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"NotConnected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"4. Enter a TokenID:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            value: tokenID,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.column,\n          children: tokenExists ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: [\"Token \", tokenID, \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 11\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"h5\", {\n                children: [url, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: [\"Owner of token \", tokenID, \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 9\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"h5\", {\n                children: owner\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 44\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 11\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: /*#__PURE__*/_jsxDEV(\"h4\", {\n              children: doesntExist\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \" 5. Mint Your Token\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => Mint(),\n          children: \" Mint Token \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.componentheaders,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.componentspacing,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Transfer Ownership\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleRecieverSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: reciever,\n            onChange: handleRecieverChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 9\n        }, this), transactionStatus ? /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Transaction Was Succesfull\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: TransferToken,\n          children: \"Transfer Token\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ContractInteraction, \"YZoQzaQK2irrfK7oCK9PLxue6SQ=\");\n\n_c = ContractInteraction;\nexport default ContractInteraction;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContractInteraction\");","map":{"version":3,"sources":["/Users/rhysconnolly/SKEEEEET/client/src/components/ContractInteraction.js"],"names":["React","useState","Component","MusicOwnership","Web3","detectEthereumProvider","styles","UploadMetadata","ContractInteraction","props","accounts","setAccounts","web3","setWeb3","undefined","contract","setContract","uri","setUri","tokenID","setTokenID","tokenExists","setTokenExists","reciever","setReciever","url","setUrl","doesntExist","setDoesntExist","account","setAccount","connectionStatus","setConnectionStatus","id","setID","cid","setCid","showCIDs","owner","setOwner","transactionStatus","setTransactionStatus","handleSubmit","evt","preventDefault","console","log","RetrieveTokenURL","handleChange","e","target","value","init","CIDkey","tokenIDs","window","ethereum","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","Contract","abi","address","error","alert","configureAndConnectMetamask","provider","mustBeMetaMask","request","method","params","chainId","chainName","nativeCurrency","name","symbol","decimals","rpcUrls","blockExplorerUrls","Mint","checkID","methods","tokenURI","call","mint","send","from","gas","JSON","stringify","ownerOf","handleRecieverSubmit","handleRecieverChange","TransferToken","transfer","componentheaders","componentspacing","column"],"mappings":"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","sourcesContent":["import React, {useState,Component} from 'react';\nimport MusicOwnership from '../artifacts/MusicOwnership.json';\nimport Web3 from 'web3';\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport styles from './CSS Modules/FileInputButtons-style.module.css';\nimport UploadMetadata from \"./UploadMetadata\";\n\n  function ContractInteraction (props) {\n\n    ///////Webpage State components///////\n    const [accounts, setAccounts] = useState([]); //state variable for accounts\n    const [web3, setWeb3] = useState (undefined); //web3 state\n    const [contract, setContract] = useState (undefined); //contract state\n    const [uri, setUri] = useState (undefined); //Uri code State\n    const [tokenID, setTokenID] = useState (undefined); //Token ID state\n    const [tokenExists, setTokenExists] = useState (false); //Triggers Token UI response on and off\n    const [reciever,setReciever ] = useState (undefined);\n    const [url, setUrl] = useState (undefined); //Metadata URL state\n    const [doesntExist, setDoesntExist] = useState(undefined); //switch for Token ID response\n    const [account, setAccount] = useState(false); //Switch for accounts connection status\n    const [connectionStatus, setConnectionStatus] = useState(false);\n    const [id, setID] = useState(undefined);\n    const [cid, setCid] =useState(props.showCIDs);\n    const [owner, setOwner] = useState(undefined);\n    const [transactionStatus,setTransactionStatus] = useState(false);\n\n    ///////Function for submitting a token Id////////\n    const handleSubmit = (evt) => {\n      evt.preventDefault();\n      setCid(props.showCIDs);\n      console.log(props.showCIDs);\n      console.log(tokenID);\n      RetrieveTokenURL(tokenID);\n    }\n    const handleChange = (e) => {\n    setTokenID(e.target.value)\n    }\n    \n    //Initialise state variables and connect to Smart Contract//\n    async function init() {\n             \n      try {\n          const uri = await (props.CIDkey); \n          const tokenID = await (props.tokenIDs);   \n          const  web3 = await new Web3(window.ethereum);\n          const accounts = await  web3.eth.getAccounts();\n          const networkId = await web3.eth.net.getId();\n          const deployedNetwork = MusicOwnership.networks[networkId];\n          const contract = await new web3.eth.Contract(\n          MusicOwnership.abi,\n          deployedNetwork && deployedNetwork.address\n          );\n          console.log(contract)\n          await setUri(uri);\n          await setWeb3(web3);\n          await setAccounts(accounts);\n          await setContract(contract);\n          console.log(tokenID);\n          console.log(uri);\n          setAccount(true)\n          }\n\n      catch (error) {\n        alert(`Failed to load web3, accounts or contract from the abi. Check console For details.`);\n        console.error(error);\n      }\n    }\n    \n    ///////Configure wallet and connect to Metamask///////\n\n    async function configureAndConnectMetamask() {\n      const provider = await detectEthereumProvider({\n        mustBeMetaMask: true\n      })\n      if (provider) {\n        try {\n          await provider.request({ method: 'eth_requestAccounts'})\n          await provider.request({\n            method: 'wallet_addEthereumChain',\n            params: [{\n              chainId: '0x3', \n              chainName: 'Ropsten',\n              nativeCurrency: {\n                name: 'ETH',\n                symbol: 'ETH',\n                decimals: 18\n               },\n              rpcUrls: ['https://ropsten.infura.io/v3/b3b18fff97b6463ca552f9334d7fe15f'],\n              blockExplorerUrls: ['https://ropsten.etherscan.io']\n            }]\n          }\n          )\n        } catch(e) {\n          console.error(e);\n          setConnectionStatus(true);\n        }  \n      } else {\n        console.error('Please install MetaMask');\n        alert('Please install the MetaMask wallet extension in Chrome or Brave Browser');\n      }\n      await init();\n    }\n\n \n        ////////////Mint a new Token////////////\n        async function Mint() {\n            if (uri === undefined || tokenID === undefined) {\n                alert('please ensure a file first and that you have entered a numerical Identification number');\n                throw('please ensure a file is submitted first and that you have entered a numerical Identification number');\n            }\n            let checkID = await contract.methods.tokenURI(tokenID).call();\n\n              if (checkID =! null)\n            {\n              alert('This ID number has been taken, please try a different number');\n              throw('This ID number has been taken, please try a different number');\n            }\n           \n            await contract.methods.mint(accounts[0],uri,tokenID).send({from:accounts[0], gas: 1000000});\n            }\n    \n            if(typeof web3 !== 'undefined'\n               && typeof accounts !== 'undefined'\n               && typeof contract !== 'undefined') {\n            }\n\n            /////////Retrieve a Token's Metadata and source File/////////\n            async function RetrieveTokenURL() {\n            if (tokenID === undefined)\n            {\n              alert('please enter a numerical Identification number');\n              throw('please enter a numerical Identification number');\n            }\n            \n            try{\n               const url = await contract.methods.tokenURI(tokenID).call();\n              setUrl(url);\n              console.log(JSON.stringify(url));\n              const owner = await contract.methods.ownerOf(tokenID).call();\n              setOwner(owner);\n              setTokenExists(true);\n            }\n            catch(error)\n            {\n            setDoesntExist('This Token ID does not exit');\n            setTokenExists(false);\n            }\n          }\n\n            \n              \n              const handleRecieverSubmit = (evt) => {\n                evt.preventDefault();\n                alert(`Submitting ID: ${reciever}`)\n                setReciever(reciever);\n              }\n              const handleRecieverChange = (e) => {\n              setReciever(e.target.value)\n              }\n              \n              async function TransferToken()\n              {\n                console.log(reciever);\n                console.log(tokenID);\n                console.log(accounts[0]);\n                if ({reciever} == null || {tokenID} == null || accounts[0] == null)\n                {\n                  alert('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n                  throw('Please ensure an address to send the token to has been submitted.\\nPlease also ensure a token identifier has been submitted')\n                }\n\n                try\n                {\n                await contract.methods.transfer({reciever},accounts[0],{tokenID}).send({from:accounts[0], gas: 1000000});\n                console.log(reciever)\n                setTransactionStatus(true);\n                }\n                catch(error)\n                {\n                  alert('Transaction failed. \\nPlease ensure the token you wish to transfer exists and that you`re wallet contains the token');\n                }\n              }\n  return (\n    <div>\n      <div className = {styles.componentheaders}> \n      <div className = {styles.componentspacing}>\n      <h2>\n        3. Connect To Your Wallet\n      </h2>\n       <div> \n          <button onClick={() => configureAndConnectMetamask() }>Connect to Ropsten </button>\n        </div>\n        {connectionStatus ? (\n        <div> \n          <h3>Account:</h3>\n          <h5> {accounts[0]}</h5>\n        </div>) : (<h4>NotConnected</h4>)}\n          </div>\n          </div>\n     \n      <div className = {styles.componentheaders}> \n      <div className = {styles.componentspacing}>\n        <h2>4. Enter a TokenID:</h2>\n        <form onSubmit= {handleSubmit}>\n        <input\n        type=\"number\"\n        value={tokenID}\n        onChange= {handleChange}\n        />\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n\n      <div className={styles.column}>\n       \n        {tokenExists ? (\n          <div>\n        <p> \n          <h3>Token {tokenID}:</h3> <h5>{url} </h5>\n        </p>\n        <p> \n        <h4>Owner of token {tokenID}:</h4> <h5>{owner}</h5>\n        </p>\n        </div>\n        ) : (\n          <p>\n          <h4>{doesntExist}</h4>\n        </p>\n        )}\n        </div>\n        </div>\n        </div>\n\n        <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n\n          <h2> 5. Mint Your Token</h2>\n          <button onClick = {() => Mint()}> Mint Token </button>\n        </div>\n        </div>\n\n        <div className = {styles.componentheaders}> \n        <div className = {styles.componentspacing}>\n        <h2>Transfer Ownership</h2>\n        <form onSubmit= {handleRecieverSubmit}> \n        <input\n        type=\"text\"\n        value={reciever}\n        onChange= {handleRecieverChange}\n        />\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n      {transactionStatus ? (\n        <h4>Transaction Was Succesfull</h4>\n      ) : (<p></p>)}\n      <button onClick={TransferToken}>Transfer Token</button>\n      </div>\n      </div>\n      </div>\n     \n  );\n}\nexport default ContractInteraction"]},"metadata":{},"sourceType":"module"}